# Google Sheets ë°ì´í„° ìˆ˜ì§‘ ì„¤ì • ê°€ì´ë“œ

ì´ ê°€ì´ë“œëŠ” Talren SPR ì‹¤í—˜ ë°ì´í„°ë¥¼ Google Sheetsì— ìë™ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

1. [Google Sheets ìƒì„±](#1-google-sheets-ìƒì„±)
2. [Apps Script ë°°í¬](#2-apps-script-ë°°í¬)
3. [ì‹¤í—˜ ì½”ë“œ ì„¤ì •](#3-ì‹¤í—˜-ì½”ë“œ-ì„¤ì •)
4. [í…ŒìŠ¤íŠ¸](#4-í…ŒìŠ¤íŠ¸)
5. [ë°ì´í„° êµ¬ì¡°](#5-ë°ì´í„°-êµ¬ì¡°)

---

## 1. Google Sheets ìƒì„±

### 1.1 ìƒˆ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë§Œë“¤ê¸°

1. [Google Sheets](https://sheets.google.com) ì ‘ì†
2. **ìƒˆë¡œ ë§Œë“¤ê¸°** â†’ **ë¹ˆ ìŠ¤í”„ë ˆë“œì‹œíŠ¸** í´ë¦­
3. ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì´ë¦„ì„ `Talren_SPR_Data` (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)ë¡œ ë³€ê²½

### 1.2 ì‹œíŠ¸ êµ¬ì¡°

Apps Scriptê°€ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì‹œíŠ¸ë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤:
- `SPR_Data`: ë¬¸ì¥ ì½ê¸° ë°ì´í„°
- `Rating_Data`: ê·¸ëŸ´ë“¯í•¨ í‰ê°€ ë°ì´í„°
- `Recall_Data`: ììœ  íšŒìƒ ë°ì´í„°
- `Manipulation_Check`: ì¡°ì‘ ì ê²€ ë°ì´í„°
- `Metadata`: ì°¸ê°€ì ë©”íƒ€ë°ì´í„°

> **ì°¸ê³ **: ì‹œíŠ¸ë¥¼ ë¯¸ë¦¬ ë§Œë“¤ í•„ìš” ì—†ìŠµë‹ˆë‹¤. ì²« ë°ì´í„° ì €ì¥ ì‹œ ìë™ ìƒì„±ë©ë‹ˆë‹¤.

---

## 2. Apps Script ë°°í¬

### 2.1 Apps Script ì—´ê¸°

1. Google Sheetsì—ì„œ **í™•ì¥ í”„ë¡œê·¸ë¨** > **Apps Script** í´ë¦­
2. ìƒˆ í”„ë¡œì íŠ¸ê°€ ì—´ë¦½ë‹ˆë‹¤ (ê¸°ë³¸ ì´ë¦„: `ë‚´ í”„ë¡œì íŠ¸`)

### 2.2 ì½”ë“œ ë³µì‚¬

1. ê¸°ì¡´ ì½”ë“œë¥¼ ëª¨ë‘ ì‚­ì œ
2. `google-apps-script.js` íŒŒì¼ì˜ ë‚´ìš©ì„ ì „ì²´ ë³µì‚¬
3. Apps Script ì—ë””í„°ì— ë¶™ì—¬ë„£ê¸°
4. **í”„ë¡œì íŠ¸ ì´ë¦„**ì„ `Talren SPR Data Collector`ë¡œ ë³€ê²½ (ì„ íƒì‚¬í•­)
5. **ì €ì¥** ë²„íŠ¼ í´ë¦­ (ğŸ’¾ ì•„ì´ì½˜)

### 2.3 ì›¹ ì•±ìœ¼ë¡œ ë°°í¬

1. ìš°ì¸¡ ìƒë‹¨ **ë°°í¬** > **ìƒˆ ë°°í¬** í´ë¦­
2. **ë°°í¬ ìœ í˜• ì„ íƒ**ì—ì„œ **ì›¹ ì•±** ì„ íƒ
3. ì„¤ì •:
   ```
   ì„¤ëª…: Talren SPR Data Collection v1
   ì‹¤í–‰ ê³„ì •: ë‚˜
   ì•¡ì„¸ìŠ¤ ê¶Œí•œ: ëª¨ë“  ì‚¬ìš©ì
   ```
4. **ë°°í¬** ë²„íŠ¼ í´ë¦­
5. âš ï¸ **ê¶Œí•œ ìŠ¹ì¸** í•„ìš”:
   - "ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¶€ì—¬" í´ë¦­
   - Google ê³„ì • ì„ íƒ
   - **ê³ ê¸‰** > **Talren SPR Data Collector(ìœ¼)ë¡œ ì´ë™** í´ë¦­
   - **í—ˆìš©** í´ë¦­

### 2.4 ì›¹ ì•± URL ë³µì‚¬

ë°°í¬ ì™„ë£Œ í›„ ë‚˜íƒ€ë‚˜ëŠ” **ì›¹ ì•± URL**ì„ ë³µì‚¬í•˜ì„¸ìš”.

ì˜ˆì‹œ:
```
https://script.google.com/macros/s/AKfycbx.../exec
```

> **ì¤‘ìš”**: ì´ URLì„ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ì„¸ìš”. ë‹¤ìŒ ë‹¨ê³„ì—ì„œ í•„ìš”í•©ë‹ˆë‹¤.

---

## 3. ì‹¤í—˜ ì½”ë“œ ì„¤ì •

### 3.1 URL ì…ë ¥

`js/experiment.js` íŒŒì¼ì„ ì—´ê³  ë‹¤ìŒ ë¶€ë¶„ì„ ì°¾ìœ¼ì„¸ìš” (ì•½ 31ë²ˆì§¸ ì¤„):

```javascript
// Google Apps Script Web App URL
// TODO: Deploy Apps Script and paste your Web App URL here
const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';
```

ë³µì‚¬í•œ ì›¹ ì•± URLë¡œ êµì²´:

```javascript
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx.../exec';
```

### 3.2 ì €ì¥ ë° í™•ì¸

1. íŒŒì¼ ì €ì¥
2. ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í—˜ ìƒˆë¡œê³ ì¹¨

---

## 4. í…ŒìŠ¤íŠ¸

### 4.1 í…ŒìŠ¤íŠ¸ ì‹¤í–‰

1. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:8000/?list=1` ì ‘ì†
2. ì‹¤í—˜ì„ ëê¹Œì§€ ì§„í–‰ (ë˜ëŠ” ë¹ ë¥´ê²Œ í´ë¦­í•´ì„œ ì™„ë£Œ)
3. ë§ˆì§€ë§‰ í™”ë©´ì—ì„œ "ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤..." ë©”ì‹œì§€ í™•ì¸
4. "ì‹¤í—˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!" ë©”ì‹œì§€ í™•ì¸

### 4.2 Google Sheets í™•ì¸

1. Google Sheetsë¡œ ëŒì•„ê°€ê¸°
2. ìƒˆë¡œ ìƒì„±ëœ ì‹œíŠ¸ë“¤ í™•ì¸:
   - `Metadata`: ì°¸ê°€ì 1ëª…ì˜ ì •ë³´
   - `SPR_Data`: 44ê°œ í–‰ (ì‹¤í—˜ + í•„ëŸ¬)
   - `Rating_Data`: 32ê°œ í–‰ (ì‹¤í—˜ ë¬¸í•­ë§Œ)
   - `Recall_Data`: 1ê°œ í–‰
   - `Manipulation_Check`: 23ê°œ í–‰

### 4.3 ë¬¸ì œ í•´ê²°

**ë°ì´í„°ê°€ ë³´ì´ì§€ ì•ŠëŠ” ê²½ìš°:**

1. **Apps Script ë¡œê·¸ í™•ì¸**:
   - Apps Script ì—ë””í„° > **ì‹¤í–‰** > **ì‹¤í–‰ ë¡œê·¸**
   - ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

2. **ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸**:
   - F12 > Console íƒ­
   - ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ í™•ì¸

3. **URL í™•ì¸**:
   - `GOOGLE_SCRIPT_URL`ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
   - URL ëì— `/exec`ê°€ ìˆëŠ”ì§€ í™•ì¸

4. **ë°°í¬ ì¬í™•ì¸**:
   - Apps Scriptì—ì„œ **ë°°í¬** > **ë°°í¬ ê´€ë¦¬**
   - ìƒíƒœê°€ "í™œì„±"ì¸ì§€ í™•ì¸

---

## 5. ë°ì´í„° êµ¬ì¡°

### 5.1 Metadata ì‹œíŠ¸

ì°¸ê°€ìë³„ ë©”íƒ€ë°ì´í„°:

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| Timestamp | ë°ì´í„° ì €ì¥ ì‹œê° |
| Participant_ID | ì°¸ê°€ì ID (6ìë¦¬) |
| List_ID | í• ë‹¹ëœ ë¦¬ìŠ¤íŠ¸ (1-4) |
| Background_Reading_Time_ms | ë°°ê²½ë¬¸ ì½ê¸° ì‹œê°„ (90ì´ˆ ì œí•œ) |
| Total_Experiment_Duration_ms | ì „ì²´ ì‹¤í—˜ ì†Œìš” ì‹œê°„ |
| Browser | ë¸Œë¼ìš°ì € ì •ë³´ |
| Screen_Width | í™”ë©´ ë„ˆë¹„ |
| Screen_Height | í™”ë©´ ë†’ì´ |

### 5.2 SPR_Data ì‹œíŠ¸

ë¬¸ì¥ ì½ê¸° ë°ì´í„° (ì°¸ê°€ìë‹¹ 44ê°œ í–‰):

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| Timestamp | ì €ì¥ ì‹œê° |
| Participant_ID | ì°¸ê°€ì ID |
| List_ID | ë¦¬ìŠ¤íŠ¸ ID |
| Trial_Index | ì‹œí–‰ ìˆœì„œ (0-43) |
| Item_ID | ìê·¹ ID (E1, E2, ..., F1, F2, ...) |
| Base | Base ë²ˆí˜¸ (B1-B8) |
| Emotion | ê°ì • ì¡°ê±´ (H/N) |
| Plausibility | ê·¸ëŸ´ë“¯í•¨ (P/I) |
| Version | ë²„ì „ (1/2) |
| Is_Filler | í•„ëŸ¬ ì—¬ë¶€ (0/1) |
| Sentence_Text | ë¬¸ì¥ ì „ì²´ |
| Total_Regions | ì§€ì—­ ê°œìˆ˜ |
| Total_Reading_Time_ms | ì´ ì½ê¸° ì‹œê°„ |
| Regions | ì§€ì—­ë³„ í…ìŠ¤íŠ¸ (JSON ë°°ì—´) |
| Region_RTs | ì§€ì—­ë³„ RT (JSON ë°°ì—´) |

**Regions ë° Region_RTs íŒŒì‹± ì˜ˆì‹œ (R)**:
```r
library(jsonlite)
library(tidyverse)

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
spr_data <- read_csv("SPR_Data.csv")

# JSON ë°°ì—´ íŒŒì‹±
spr_data <- spr_data %>%
  mutate(
    regions_list = map(Regions, fromJSON),
    rts_list = map(Region_RTs, fromJSON)
  )

# ì§€ì—­ë³„ë¡œ í¼ì¹˜ê¸°
spr_long <- spr_data %>%
  unnest_longer(c(regions_list, rts_list), indices_to = "region_index") %>%
  rename(
    region_text = regions_list,
    region_rt = rts_list
  )
```

### 5.3 Rating_Data ì‹œíŠ¸

ê·¸ëŸ´ë“¯í•¨ í‰ê°€ ë°ì´í„° (ì°¸ê°€ìë‹¹ 32ê°œ í–‰):

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| Timestamp | ì €ì¥ ì‹œê° |
| Participant_ID | ì°¸ê°€ì ID |
| List_ID | ë¦¬ìŠ¤íŠ¸ ID |
| Item_ID | ìê·¹ ID |
| Base | Base ë²ˆí˜¸ |
| Emotion | ê°ì • ì¡°ê±´ |
| Plausibility | ê·¸ëŸ´ë“¯í•¨ |
| Stimulus_Text | ë¬¸ì¥ |
| Rating | í‰ê°€ (1-5) |
| RT_ms | ë°˜ì‘ ì‹œê°„ |

### 5.4 Recall_Data ì‹œíŠ¸

ììœ  íšŒìƒ ë°ì´í„° (ì°¸ê°€ìë‹¹ 1ê°œ í–‰):

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| Timestamp | ì €ì¥ ì‹œê° |
| Participant_ID | ì°¸ê°€ì ID |
| List_ID | ë¦¬ìŠ¤íŠ¸ ID |
| Recall_Text | íšŒìƒ ë‚´ìš© |

### 5.5 Manipulation_Check ì‹œíŠ¸

ì¡°ì‘ ì ê²€ ë°ì´í„° (ì°¸ê°€ìë‹¹ 23ê°œ í–‰):

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| Timestamp | ì €ì¥ ì‹œê° |
| Participant_ID | ì°¸ê°€ì ID |
| List_ID | ë¦¬ìŠ¤íŠ¸ ID |
| Modifier_Text | ìˆ˜ì‹ì–´ |
| Modifier_Category | ë²”ì£¼ (hate/neutral) |
| Negativity_Rating | ë¶€ì •ì„± í‰ê°€ (1-7) |
| RT_ms | ë°˜ì‘ ì‹œê°„ |

---

## 6. ë°ì´í„° ë‹¤ìš´ë¡œë“œ

### 6.1 CSVë¡œ ë‚´ë³´ë‚´ê¸°

ê° ì‹œíŠ¸ë¥¼ ê°œë³„ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ:
1. ì‹œíŠ¸ ì„ íƒ
2. **íŒŒì¼** > **ë‹¤ìš´ë¡œë“œ** > **ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ê°’(.csv)**

### 6.2 ì „ì²´ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë‹¤ìš´ë¡œë“œ

**íŒŒì¼** > **ë‹¤ìš´ë¡œë“œ** > **Microsoft Excel (.xlsx)**

---

## 7. ë³´ì•ˆ ë° ê¶Œí•œ

### 7.1 ë°ì´í„° ì ‘ê·¼ ê¶Œí•œ

- ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì†Œìœ ìë§Œ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì›¹ ì•± URLì„ ì•„ëŠ” ì‚¬ëŒì€ ë°ì´í„°ë¥¼ ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- URLì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ì„¸ìš”

### 7.2 ë°ì´í„° ë°±ì—…

- Google SheetsëŠ” ìë™ìœ¼ë¡œ ë²„ì „ ê¸°ë¡ì„ ìœ ì§€í•©ë‹ˆë‹¤
- ì •ê¸°ì ìœ¼ë¡œ ë¡œì»¬ì— ë°±ì—…í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤
- ì‹¤í—˜ ì¢…ë£Œ í›„ì—ë„ CSV ë°±ì—…ì´ ìë™ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤

---

## 8. ê³ ê¸‰ ì„¤ì •

### 8.1 Apps Script ì¬ë°°í¬

ì½”ë“œë¥¼ ìˆ˜ì •í•œ ê²½ìš°:
1. Apps Script ì—ë””í„°ì—ì„œ ì½”ë“œ ìˆ˜ì •
2. **ì €ì¥**
3. **ë°°í¬** > **ë°°í¬ ê´€ë¦¬**
4. ê¸°ì¡´ ë°°í¬ ì˜† **í¸ì§‘** í´ë¦­
5. **ë²„ì „** > **ìƒˆ ë²„ì „**
6. **ë°°í¬**

**ì¤‘ìš”**: URLì€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ `experiment.js`ë¥¼ ìˆ˜ì •í•  í•„ìš” ì—†ìŠµë‹ˆë‹¤.

### 8.2 ì´ë©”ì¼ ì•Œë¦¼ ì¶”ê°€

ë°ì´í„°ê°€ ì €ì¥ë  ë•Œë§ˆë‹¤ ì´ë©”ì¼ ë°›ê¸°:

Apps Scriptì— ë‹¤ìŒ í•¨ìˆ˜ ì¶”ê°€:
```javascript
function sendEmailNotification(participantId, listId) {
  const email = 'your-email@example.com'; // ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥
  const subject = `ìƒˆ ì°¸ê°€ì ë°ì´í„°: P${participantId} (List ${listId})`;
  const body = `ìƒˆë¡œìš´ ì°¸ê°€ì ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì°¸ê°€ì ID: ${participantId}\në¦¬ìŠ¤íŠ¸: ${listId}\nì‹œê°„: ${new Date()}`;

  MailApp.sendEmail(email, subject, body);
}
```

`saveCompleteData` í•¨ìˆ˜ ëì— ì¶”ê°€:
```javascript
sendEmailNotification(data.participant_id, data.list_id);
```

---

## 9. ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜

**"Access denied" ì˜¤ë¥˜**
- ë°°í¬ ì‹œ "ëª¨ë“  ì‚¬ìš©ì" ê¶Œí•œ í™•ì¸
- ì¬ë°°í¬ ì‹œë„

**"Script function not found"**
- Apps Script ì½”ë“œê°€ ì˜¬ë°”ë¥´ê²Œ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸
- í•¨ìˆ˜ ì´ë¦„ ì˜¤íƒ€ í™•ì¸

**ë°ì´í„°ê°€ ì¤‘ë³µ ì €ì¥ë¨**
- ì°¸ê°€ìê°€ ìƒˆë¡œê³ ì¹¨í–ˆê±°ë‚˜ ë’¤ë¡œê°€ê¸° ì‚¬ìš©
- Timestampë¡œ ì¤‘ë³µ ì œê±° ê°€ëŠ¥

**ë¡œë”© í™”ë©´ì—ì„œ ë©ˆì¶¤**
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
- Apps Script URLì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì˜¤ë¥˜ í™•ì¸

---

## 10. ì°¸ê³  ìë£Œ

- [Google Apps Script ë¬¸ì„œ](https://developers.google.com/apps-script)
- [jsPsych ë¬¸ì„œ](https://www.jspsych.org/)
- [Google Sheets API](https://developers.google.com/sheets/api)

---

**ì„¤ì • ì™„ë£Œ!** ğŸ‰

ì´ì œ ì‹¤í—˜ ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ Google Sheetsì— ì €ì¥ë©ë‹ˆë‹¤.
